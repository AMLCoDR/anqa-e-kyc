/*!
 * GBG - WJCS
 * Version: 8.9.1
 * Build Mode: Production
 * Build Timestamp: 1600238175421
 * Build Time: 2020-09-16T06:36:15.421Z
 * Chunk Hash: f7e01423119982a74ba4
 */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("Idscan",[],r):"object"==typeof exports?exports.Idscan=r():(e.GBG=e.GBG||{},e.GBG.Idscan=r())}(this,function(){return function(e){var r={};function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(o,n,function(r){return e[r]}.bind(null,n));return o},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=132)}({132:function(e,r,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var n=t(38),i=function(){return function(e){var r=this;this.postMessage=function(e,t,o){return new Promise(function(n){return n(r.workerGlobalContext.postMessage({id:e,message:t,data:o}))})},this.onError=function(e){return r.postMessage("",n.IdesMicroWorkerMessages.Error,o({},e))},this.onMessage=function(e){var t=e.data;switch(t.message){case n.IdesMicroWorkerMessages.PerformQualityCheck:return r.onPerformQualityCheck(t.id,t.data);case n.IdesMicroWorkerMessages.Terminate:return r.postMessage(t.id,n.IdesMicroWorkerMessages.Terminate).then(function(){return r.workerGlobalContext.close()});case n.IdesMicroWorkerMessages.Initialise:return r.onInitialise(t.data.asmScriptUrl,t.data.timeout).then(function(){return r.postMessage(t.id,n.IdesMicroWorkerMessages.ReadyToProcess)}).catch(function(){return r.postMessage(t.id,n.IdesMicroWorkerMessages.Error)})}},this.onInitialise=function(e,t){return void 0===e&&(e="./idesmicro_asm.js"),void 0===t&&(t=6e4),new Promise(function(o,n){if(r.idesMicro)return o();r.workerGlobalContext.importScripts(e);var i=setTimeout(function(){return n()},t);return r.workerGlobalContext.InitIdesmicro().then(function(e){clearTimeout(i),r.idesMicro=e,o()})})},this.onPerformQualityCheck=function(e,t){var o=t.image,i=t.threshold;return r.checkQuality(o,i).then(function(t){return r.postMessage(e,n.IdesMicroWorkerMessages.CheckComplete,t)}).catch(function(t){return r.postMessage(e,n.IdesMicroWorkerMessages.CheckFailed,t.message)})},this.checkQuality=function(e,t){return r.checkImageQuality(e,t).then(function(t){var o=t.blurCheck,n=t.glareCheck;return 0===o&&0===n?r.detectDocument(e).then(function(t){return r.checkLowResolution(e,t).then(function(e){var r=e.resolutionCheck;return{quality:{blurCheck:!Boolean(o),glareCheck:!Boolean(n),resolutionCheck:!Boolean(r)},coords:[[t.xTL,t.yTL],[t.xTR,t.yTR],[t.xBR,t.yBR],[t.xBL,t.yBL]]}})}):Promise.resolve({quality:{blurCheck:!Boolean(o),glareCheck:!Boolean(n),resolutionCheck:!1},coords:[]})})},this.checkImageQuality=function(e,t){return new Promise(function(o){var n=e.length*e.BYTES_PER_ELEMENT,i=r.idesMicro._malloc(n),s=new Uint8Array(r.idesMicro.HEAPU8.buffer,i,n);s.set(e);var c=r.idesMicro.checkImageQuality(s.byteOffset,e.length,t);return r.idesMicro._free(i),o(void 0===c?{blurCheck:1,glareCheck:1}:c)})},this.detectDocument=function(e){return new Promise(function(t){var o=e.length*e.BYTES_PER_ELEMENT,n=r.idesMicro._malloc(o),i=new Uint8Array(r.idesMicro.HEAPU8.buffer,n,o);i.set(e);var s=r.idesMicro.detectDocument(i.byteOffset,e.length);return r.idesMicro._free(n),t(s)})},this.checkLowResolution=function(e,t){return new Promise(function(o){var n=e.length*e.BYTES_PER_ELEMENT,i=r.idesMicro._malloc(n),s=new Uint8Array(r.idesMicro.HEAPU8.buffer,i,n);s.set(e);var c=r.idesMicro.checkLowResolution(s.byteOffset,e.length,t);return r.idesMicro._free(i),o(c)})},this.workerGlobalContext=e,this.workerGlobalContext.addEventListener("message",this.onMessage),this.workerGlobalContext.addEventListener("error",this.onError)}}();r.IdesMicroWorker=i,r.default=new i(self)},38:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e.CheckComplete="CheckComplete",e.CheckFailed="CheckFailed",e.Initialise="Initialise",e.Terminate="Terminate",e.LoadingResources="LoadingResources",e.PerformQualityCheck="PerformQualityCheck",e.ReadyToProcess="ReadyToProcess",e.Error="Error"}(r.IdesMicroWorkerMessages||(r.IdesMicroWorkerMessages={}))}})});